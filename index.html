<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
    		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css">
    		<link rel="stylesheet" type="text/css" href="https://bootswatch.com/4/default/bootstrap.css">
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
		<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>	
	</head>
	<body style="margin: 20px">
		<ul class="nav nav-tabs">
			<li class="nav-item">
				<a class="nav-link" data-toggle="tab" href="#world">Simulation</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" data-toggle="tab" href="#graph">Sensor</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" data-toggle="tab" href="#code">Code</a>
			</li>
		</ul>
		<div class="tab-content">
			<div class="tab-pane active" id="world">
				<form style="float: right; margin-top: 60px" method="get">
					<fieldset class="form-group">
    	  				<label for="kp">$$K_p$$</label>
						<input type="range" min="0" step="0.1" max="10" class="custom-range" name="kp" id="kp">
					</fieldset>
					<fieldset class="form-group">
						<label for="ki">$$K_i$$</label>
						<input type="range" min="0" step="0.001" max="0.1" class="custom-range" name="ki" id="ki">
					</fieldset>
					<fieldset class="form-group">
						<label for="kd">$$K_d$$</label>
						<input type="range" min="0" step="1" max="100" class="custom-range" name="kd" id="kd">
					</fieldset>
					<button type="submit" id="butt">Restart Engine</button>
				</form>
			</div>
			<div class="tab-pane" id="graph" style="width: 800"></div>
			<div class="tab-pane" id="code">
				<h2>Python (MicroPython)</h2>
				<pre>
					previous_error = 0
					integral = 0
					while True:
						error = 90 - sensor.value()
						integral = integral + error*dt
						derivative = (error - previous_error)/dt
						output = Kp*error + Ki*integral + Kd*derivative
						servo.speed(output)
						previous_error = error
						time.sleep(dt)
				</pre>
				<h2>C++ (Arduino)</h2>
				<pre>
					double previousError = 0;
					double integral = 0;
					double error;
					double integral;
					double derivative;
					double output;
					while (true) {
						error = 90 - analogRead(sensor);
						integral = integral + error*dt;
						derivative = (error - previousError)/dt;
						output = Kp*error + Ki*integral + Kd*derivative;
						servo.write(output);
						usleep(dt);
					}
				</pre>
			</div>
		</div>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.14.2/matter.js"></script>
		<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
		<script src="pid.js"></script>
	</body>
</html>
